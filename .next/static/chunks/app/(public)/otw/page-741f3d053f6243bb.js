(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[528],{1859:(e,s,t)=>{"use strict";t.d(s,{default:()=>n});var r=t(5155),l=t(2115),a=t(6152),i=t.n(a);let n=()=>{let[e,s]=(0,l.useState)([]),[t,a]=(0,l.useState)(!1),[n,u]=(0,l.useState)(null),c=async()=>{try{a(!0),u(null);let e=await fetch("/api/otw/requests?customerId=".concat(encodeURIComponent("cus_demo_1"))),t=await e.json();if(!e.ok||!t.success){u(t.error||"Unable to load your OTW requests right now."),s([]);return}s(t.requests||[])}catch(e){console.error("Error loading OTW requests:",e),u("Network error while loading your OTW requests."),s([])}finally{a(!1)}};return(0,l.useEffect)(()=>{c()},[]),(0,r.jsxs)("div",{className:i().shell,children:[(0,r.jsxs)("div",{className:i().headerRow,children:[(0,r.jsx)("h2",{className:i().title,children:"My OTW Requests"}),(0,r.jsx)("button",{type:"button",className:i().refreshButton,onClick:c,disabled:t,children:t?"Refreshing...":"Refresh"})]}),n&&(0,r.jsx)("p",{className:i().error,children:n}),!n&&!t&&0===e.length&&(0,r.jsx)("p",{className:i().empty,children:"No OTW runs yet. Book your first one above."}),(0,r.jsx)("ul",{className:i().list,children:e.map(e=>{var s;return(0,r.jsxs)("li",{className:i().item,children:[(0,r.jsxs)("div",{className:i().rowTop,children:[(0,r.jsx)("span",{className:i().badge,children:e.serviceType}),(0,r.jsx)("span",{className:i().status,children:e.status})]}),(0,r.jsxs)("p",{className:i().meta,children:["Request ID: ",(0,r.jsx)("span",{children:e.id})]}),(0,r.jsxs)("p",{className:i().meta,children:["Created:"," ",(0,r.jsx)("span",{children:new Date(e.createdAt).toLocaleString()})]}),(0,r.jsxs)("p",{className:i().meta,children:["Estimated OTW Miles:"," ",(0,r.jsx)("span",{children:null!=(s=e.estimatedMiles)?s:"—"})]}),(0,r.jsxs)("p",{className:i().meta,children:["Distance:"," ",(0,r.jsx)("span",{children:null!=e.estimatedDistanceKm?"".concat(e.estimatedDistanceKm.toFixed(1)," km"):"—"})]}),(0,r.jsxs)("p",{className:i().meta,children:["Time Estimate:"," ",(0,r.jsx)("span",{children:null!=e.estimatedDurationMinutes?"".concat(e.estimatedDurationMinutes," min"):"—"})]}),e.notes&&(0,r.jsxs)("p",{className:i().notes,children:["Notes: ",e.notes]})]},e.id)})})]})}},4219:e=>{e.exports={shell:"OtwRequestForm_shell__rbB5Z",title:"OtwRequestForm_title__jy3mn",subtitle:"OtwRequestForm_subtitle__gBzbB",form:"OtwRequestForm_form__T_fH6",label:"OtwRequestForm_label__N_jAx",input:"OtwRequestForm_input__ezbYk",select:"OtwRequestForm_select__eGysv",textarea:"OtwRequestForm_textarea__x5htt",helpText:"OtwRequestForm_helpText__LJuNZ",submitButton:"OtwRequestForm_submitButton__703K3",error:"OtwRequestForm_error__xkqZF",successBox:"OtwRequestForm_successBox__JRKA0",successTitle:"OtwRequestForm_successTitle__sVxTP",successLine:"OtwRequestForm_successLine__4Knht",upgradeBox:"OtwRequestForm_upgradeBox__uA1yv",upgradeTitle:"OtwRequestForm_upgradeTitle__FboZ4",upgradeLine:"OtwRequestForm_upgradeLine___FWJv"}},5160:(e,s,t)=>{Promise.resolve().then(t.bind(t,1859)),Promise.resolve().then(t.bind(t,8628))},6152:e=>{e.exports={shell:"MyOtwRequests_shell__FUOMN",headerRow:"MyOtwRequests_headerRow__vWBPs",title:"MyOtwRequests_title__54k41",refreshButton:"MyOtwRequests_refreshButton__o61Oc",error:"MyOtwRequests_error__8CcYJ",empty:"MyOtwRequests_empty__FwP33",list:"MyOtwRequests_list__S1Uc9",item:"MyOtwRequests_item__4Q3rP",rowTop:"MyOtwRequests_rowTop__RmPMv",badge:"MyOtwRequests_badge__QnxUC",status:"MyOtwRequests_status__YLU_v",meta:"MyOtwRequests_meta__t8Vnm",notes:"MyOtwRequests_notes__BTNe1"}},8628:(e,s,t)=>{"use strict";t.d(s,{default:()=>u});var r=t(5155),l=t(2115),a=t(4219),i=t.n(a);let n=[{value:"ERRAND",label:"Errand / Groceries"},{value:"FOOD",label:"Food Pickup"},{value:"BIG_HAUL",label:"Big Haul (TV, appliances)"},{value:"VIP",label:"VIP Concierge"}],u=()=>{var e,s,t,a,u;let[c,o]=(0,l.useState)("ERRAND"),[d,m]=(0,l.useState)(500),[_,h]=(0,l.useState)(""),[p,x]=(0,l.useState)("idle"),[g,N]=(0,l.useState)(null),[w,j]=(0,l.useState)(null),O=async e=>{e.preventDefault(),x("submitting"),N(null),j(null);try{let e=await fetch("/api/otw/requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:"cus_demo_1",serviceType:c,estimatedMiles:d,notes:_||void 0})}),s=await e.json();if(!e.ok||!s.success){x("error"),N(s.error||"Something went wrong while creating your OTW request."),j(s);return}x("success"),j(s),h("")}catch(e){console.error("OTW request error:",e),x("error"),N("Network error while creating OTW request.")}};return(0,r.jsxs)("div",{className:i().shell,children:[(0,r.jsx)("h2",{className:i().title,children:"Book an OTW Run"}),(0,r.jsx)("p",{className:i().subtitle,children:"Choose your service, enter estimated OTW miles, and send it OTW."}),(0,r.jsxs)("form",{className:i().form,onSubmit:O,children:[(0,r.jsxs)("label",{className:i().label,children:["Service Type",(0,r.jsx)("select",{className:i().select,value:c,onChange:e=>o(e.target.value),children:n.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("label",{className:i().label,children:["Estimated OTW Miles",(0,r.jsx)("input",{type:"number",min:1,step:10,className:i().input,value:d,onChange:e=>m(Number(e.target.value)||0)}),(0,r.jsx)("span",{className:i().helpText,children:"This represents internal OTW miles, not literal road miles."})]}),(0,r.jsxs)("label",{className:i().label,children:["Notes (optional)",(0,r.jsx)("textarea",{className:i().textarea,value:_,onChange:e=>h(e.target.value),placeholder:"Example: Pick up groceries from Kroger on Lima, drop at my apartment..."})]}),(0,r.jsx)("button",{type:"submit",className:i().submitButton,disabled:"submitting"===p,children:"submitting"===p?"Sending...":"Send OTW"}),"error"===p&&g&&(0,r.jsx)("p",{className:i().error,children:g}),"success"===p&&(null==w?void 0:w.request)&&(0,r.jsxs)("div",{className:i().successBox,children:[(0,r.jsx)("p",{className:i().successTitle,children:"Request Created ✅"}),(0,r.jsxs)("p",{className:i().successLine,children:["Request ID: ",(0,r.jsx)("strong",{children:w.request.id})]}),(0,r.jsxs)("p",{className:i().successLine,children:["Tier: ",(0,r.jsx)("strong",{children:null==(e=w.tier)?void 0:e.name})]}),(0,r.jsxs)("p",{className:i().successLine,children:["Miles Remaining:"," ",(0,r.jsx)("strong",{children:null!=(u=null==(s=w.membership)?void 0:s.milesRemaining)?u:"—"})]}),(null==(t=w.eligibility)?void 0:t.reason)&&(0,r.jsxs)("p",{className:i().successLine,children:["Eligibility: ",w.eligibility.reason]})]}),"submitting"!==p&&(null==w||null==(a=w.details)?void 0:a.suggestedUpgradeTier)&&(0,r.jsxs)("div",{className:i().upgradeBox,children:[(0,r.jsx)("p",{className:i().upgradeTitle,children:"Upgrade Recommended \uD83D\uDD3C"}),(0,r.jsxs)("p",{className:i().upgradeLine,children:[w.details.suggestedUpgradeTier.name," —"," ",w.details.suggestedUpgradeTier.description]})]})]})]})}}},e=>{e.O(0,[54,441,255,358],()=>e(e.s=5160)),_N_E=e.O()}]);