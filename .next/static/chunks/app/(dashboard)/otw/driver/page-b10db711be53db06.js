(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[104],{2946:e=>{e.exports={shell:"DriverDashboard_shell__HRkDy",headerRow:"DriverDashboard_headerRow__GQHUR",title:"DriverDashboard_title__wrcTG",refreshButton:"DriverDashboard_refreshButton____sFc",subTitle:"DriverDashboard_subTitle__yPCwA",error:"DriverDashboard_error__HRhr_",section:"DriverDashboard_section__wct1f",sectionTitle:"DriverDashboard_sectionTitle__Nu0u9",empty:"DriverDashboard_empty__YrJgG",list:"DriverDashboard_list__lQsW2",item:"DriverDashboard_item__JHRZk",rowTop:"DriverDashboard_rowTop__6EVTL",badge:"DriverDashboard_badge__7Xswa",status:"DriverDashboard_status__amXE0",meta:"DriverDashboard_meta__0SWn4",notes:"DriverDashboard_notes__JcSDB",acceptButton:"DriverDashboard_acceptButton__u1mQF",completeButton:"DriverDashboard_completeButton__fDpLS"}},7461:(e,s,t)=>{"use strict";t.d(s,{default:()=>c});var a=t(5155),r=t(2115),i=t(2946),n=t.n(i);let l="drv_demo_1",c=()=>{let[e,s]=(0,r.useState)([]),[t,i]=(0,r.useState)([]),[c,o]=(0,r.useState)(!1),[d,h]=(0,r.useState)(null),[m,u]=(0,r.useState)(null),p=async()=>{try{o(!0),u(null);let e=await fetch("/api/otw/drivers/requests?driverId=".concat(encodeURIComponent(l))),t=await e.json();if(!e.ok||!t.success){u(t.error||"Unable to load driver requests at this time."),s([]),i([]);return}s(t.myRequests||[]),i(t.openRequests||[])}catch(e){console.error("Error loading driver dashboard:",e),u("Network error while loading driver dashboard."),s([]),i([])}finally{o(!1),h(null)}};(0,r.useEffect)(()=>{p()},[]);let _=async e=>{try{h(e),u(null);let s=await fetch("/api/otw/drivers/accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({driverId:l,requestId:e})}),t=await s.json();if(!s.ok||!t.success)return void u(t.error||"Unable to accept this OTW request right now.");await p()}catch(e){console.error("Error accepting OTW request:",e),u("Network error while accepting OTW request.")}finally{h(null)}},D=async e=>{try{h(e),u(null);let s=await fetch("/api/otw/drivers/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({driverId:l,requestId:e})}),t=await s.json();if(!s.ok||!t.success)return void u(t.error||"Unable to complete this OTW request right now.");await p()}catch(e){console.error("Error completing OTW request:",e),u("Network error while completing OTW request.")}finally{h(null)}};return(0,a.jsxs)("div",{className:n().shell,children:[(0,a.jsxs)("div",{className:n().headerRow,children:[(0,a.jsx)("h2",{className:n().title,children:"Driver Dashboard"}),(0,a.jsx)("button",{type:"button",className:n().refreshButton,onClick:p,disabled:c,children:c?"Refreshing...":"Refresh"})]}),(0,a.jsxs)("p",{className:n().subTitle,children:["Demo Driver ID: ",(0,a.jsx)("span",{children:l})]}),m&&(0,a.jsx)("p",{className:n().error,children:m}),(0,a.jsxs)("section",{className:n().section,children:[(0,a.jsx)("h3",{className:n().sectionTitle,children:"My Active OTW Runs"}),0===e.length&&(0,a.jsx)("p",{className:n().empty,children:"No active runs yet. Accept an OTW to get moving."}),(0,a.jsx)("ul",{className:n().list,children:e.map(e=>{var s;let t,r;return(0,a.jsxs)("li",{className:n().item,children:[(0,a.jsxs)("div",{className:n().rowTop,children:[(0,a.jsx)("span",{className:n().badge,children:e.serviceType}),(0,a.jsx)("span",{className:n().status,children:e.status})]}),(0,a.jsxs)("p",{className:n().meta,children:["Request ID: ",(0,a.jsx)("span",{children:e.id})]}),(0,a.jsxs)("p",{className:n().meta,children:["Created:"," ",(0,a.jsx)("span",{children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsxs)("p",{className:n().meta,children:["Estimated OTW Miles:"," ",(0,a.jsx)("span",{children:null!=(s=e.estimatedMiles)?s:"—"})]}),(0,a.jsxs)("p",{className:n().meta,children:["Distance:"," ",(0,a.jsx)("span",{children:null!=e.estimatedDistanceKm?"".concat(e.estimatedDistanceKm.toFixed(1)," km"):"—"})]}),(0,a.jsxs)("p",{className:n().meta,children:["Time Estimate:"," ",(0,a.jsx)("span",{children:null!=e.estimatedDurationMinutes?"".concat(e.estimatedDurationMinutes," min"):"—"})]}),e.notes&&(0,a.jsxs)("p",{className:n().notes,children:["Notes: ",e.notes]}),"COMPLETED"!==e.status&&(0,a.jsx)("button",{type:"button",className:n().completeButton,onClick:()=>D(e.id),disabled:(t=e.id,c||d===t),children:(r=e.id,c||d===r)?"Working...":"Mark Completed"})]},e.id)})})]}),(0,a.jsxs)("section",{className:n().section,children:[(0,a.jsx)("h3",{className:n().sectionTitle,children:"Available OTW Requests"}),0===t.length&&(0,a.jsx)("p",{className:n().empty,children:"No open OTW requests at the moment."}),(0,a.jsx)("ul",{className:n().list,children:t.map(e=>{var s;let t,r;return(0,a.jsxs)("li",{className:n().item,children:[(0,a.jsxs)("div",{className:n().rowTop,children:[(0,a.jsx)("span",{className:n().badge,children:e.serviceType}),(0,a.jsx)("span",{className:n().status,children:e.status})]}),(0,a.jsxs)("p",{className:n().meta,children:["Request ID: ",(0,a.jsx)("span",{children:e.id})]}),(0,a.jsxs)("p",{className:n().meta,children:["Created:"," ",(0,a.jsx)("span",{children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsxs)("p",{className:n().meta,children:["Estimated OTW Miles:"," ",(0,a.jsx)("span",{children:null!=(s=e.estimatedMiles)?s:"—"})]}),(0,a.jsxs)("p",{className:n().meta,children:["Distance:"," ",(0,a.jsx)("span",{children:null!=e.estimatedDistanceKm?"".concat(e.estimatedDistanceKm.toFixed(1)," km"):"—"})]}),(0,a.jsxs)("p",{className:n().meta,children:["Time Estimate:"," ",(0,a.jsx)("span",{children:null!=e.estimatedDurationMinutes?"".concat(e.estimatedDurationMinutes," min"):"—"})]}),e.notes&&(0,a.jsxs)("p",{className:n().notes,children:["Notes: ",e.notes]}),(0,a.jsx)("button",{type:"button",className:n().acceptButton,onClick:()=>_(e.id),disabled:(t=e.id,c||d===t),children:(r=e.id,c||d===r)?"Processing...":"Accept OTW"})]},e.id)})})]})]})}},8972:(e,s,t)=>{Promise.resolve().then(t.bind(t,7461))}},e=>{e.O(0,[145,441,255,358],()=>e(e.s=8972)),_N_E=e.O()}]);